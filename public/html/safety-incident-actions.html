<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="google" content="notranslate">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Safety Incident Details</title>
    <link rel="icon" type="image/png" href="../assets/logo2.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
    <link rel="stylesheet" href="../css/style-2.css">
    <link rel="stylesheet" href="../css/common-header.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">
    <style>
      :root {
        --shadow-md: 0 4px 16px rgba(0, 46, 125, 0.18);
        --accent-color: #002E7D;
        --border-color: #ddd;
        --text-dark: #24313c;
      }

      body {
        font-family: 'Roboto', sans-serif;
        font-weight: 500;
        font-size: 0.75rem !important;
        padding: 0 0.25rem;
        padding-top: 60px;
        background-color: #f5f6fa;
        min-height: 100vh;
        color: #1f2933;
      }

      .container {
        padding: 0 0.5rem;
        max-width: 1200px;
        width: 100%;
        margin: 0 auto;
      }

      .form-container {
        position: relative;
        padding: 1rem;
        max-width: 900px;
        margin: 1.5rem auto 3rem;
        background: #fff;
        border-radius: 8px;
        box-shadow: var(--shadow-md);
      }

      /* Compact styling for smaller content - using !important to override conflicts */
      .form-group {
        margin-bottom: 0.5rem;
      }
      .form-group label, label {
        font-size: 0.8rem !important;
        margin-bottom: 0.2rem;
        font-weight: 500;
        display: block;
      }
      input, select, textarea, .form-group input, .form-group select, .form-group textarea {
        font-size: 0.8rem !important;
        padding: 0.4rem;
        min-height: 36px;
        height: 36px;
        line-height: 1.3;
        border-radius: 4px;
        border: 1px solid var(--border-color);
      }

      .delete-button,
      .btn-alert.red-button,
      .red-button {
        background-color: #dc3545;
        color: #fff;
      }
      .delete-button:hover,
      .red-button:hover,
      .btn-alert.red-button:hover {
        background-color: #b52a3c;
      }
      select option {
        font-size: 0.8rem !important;
        padding: 0.3rem;
        line-height: 1.2;
      }
      select:disabled {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: none;
      }
      textarea {
        height: 32px;
        resize: none;
        overflow: hidden;
      }
      textarea:not(#incidentTitle) {
        height: 80px;
        resize: vertical;
        overflow: auto;
      }
      .btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem !important;
        min-height: 32px;
      }
      h2, h3 {
        font-size: 1rem !important;
        margin-bottom: 0.5rem;
        font-weight: 600;
      }
      .form-row {
        gap: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .immediate-action-row-scroll {
        margin-bottom: 0.5rem;
      }
      .immediate-action-field textarea {
        height: 60px;
        font-size: 0.75rem !important;
      }
      .rpn-table, .rpn-table th, .rpn-table td, .repeat-alert-table, .repeat-alert-table th, .repeat-alert-table td {
        font-size: 0.75rem !important;
      }
      .rpn-table th, .rpn-table td {
        padding: 0.3rem;
      }
      .rpn-table input {
        width: 50px;
        height: 28px;
        font-size: 0.75rem !important;
      }
      .repeat-alert-select {
        font-size: 0.75rem !important;
        height: 28px;
      }
      .form-section {
        margin-bottom: 0.75rem;
      }
      .image-previews-container {
        padding: 0.5rem;
        margin-bottom: 0.5rem;
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      #rpn-calculation-section {
        background-color: #f0f0f0;
        padding: 6px;
        border-radius: 6px;
        margin-bottom: 8px;
      }
      .rpn-operator {
        margin: 0 10px;
        font-weight: bold;
      }
      .rpn-input-group label {
        display: block;
        margin-bottom: 5px;
      }
      #rpn-calculation-section .form-row {
        align-items: baseline;
      }
      #rpn {
        background-color: #fffb00;
      }
      .redirect-notice {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 0.75rem;
        border-radius: 5px;
        margin-bottom: 1rem;
        text-align: center;
        font-size: 0.8rem !important;
      }
      .redirect-notice i {
        margin-right: 8px;
        color: #f39c12;
      }
    </style>
    <!-- Add specific styles for the form -->
    <style>
      .form-container {
        position: relative;
        padding: 1rem;
        max-width: 800px;
        margin: 0.5rem auto;
        background: #fff;
        border-radius: 8px;
        box-shadow: var(--shadow-md);
      }
      .form-container h2, .form-container h3 { margin-bottom: 20px; color: var(--accent-color); }
      .form-group { margin-bottom: 15px; }
      .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: var(--text-dark); }
      .form-group input[type="text"],
      .form-group input[type="date"],
      .form-group input[type="time"],
      .form-group input[type="number"],
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        font-size: 1rem;
        box-sizing: border-box;
      }
      .form-group textarea { min-height: 80px; resize: vertical; overflow-y: auto; max-height: none; }
      .form-group input:read-only,
      .form-group select:disabled,
      .form-group textarea:read-only {
        background-color: #e9ecef;
        cursor: not-allowed;
        opacity: 0.7;
      }
      .form-actions { margin-top: 10px; text-align: right; }
      .form-actions button { padding: 0.4rem 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem; margin-left: 6px; min-height: 32px; height: 32px; }
      .btn-save { background-color: var(--accent-color); color: white; }
      .btn-back { background-color: #6c757d; color: white; }
      .btn-alert { background-color: #28a745; color: white; }
      .hidden { display: none; }
      .pre-wrap { white-space: pre-wrap; }
      .flex-row { display: flex; align-items: center; gap: 10px; }
      .flex-row label, .flex-row input, .flex-row span, .flex-row button { flex: 1; }
      .flex-row span { flex: 0; }
    </style>
</head>
<body class="bg-gray-100 text-gray-900 font-roboto-medium">
  <div class="header-container">
    <button type="button" class="header-back-button" onclick="window.history.back();" id="headerBackBtn">Back</button>
    <div class="header-title">Safety Incident Actions</div>
    <div class="company-logo">
      <a href="../index.html">
        <img src="../assets/logo.png" class="auth-logo" alt="Logo"/>
      </a>
    </div>
  </div>
  <main>
    <div class="container page-fade-in">
      <div class="form-container">
        <div class="redirect-notice">
          <i class="fas fa-info-circle"></i>
          <strong>Safety incidents are handled by HR Department.</strong><br>
          This incident has been submitted to the HR Dept. for proper action and investigation.
        </div>

        <h2 id="form-title">Safety Incident Details</h2>
        <form id="incident-form">
          <input type="hidden" id="incidentId">

          <div class="form-group">
            <label for="incidentIdDisplay">Safety Incident No.</label>
            <input type="text" id="incidentIdDisplay" readonly>
          </div>
          <div class="form-group">
            <label for="user_name">Reported By</label>
            <input type="text" id="user_name" readonly>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="incident_date">Date of Occurrence:</label>
              <input type="date" id="incident_date" readonly>
            </div>
            <div class="form-group">
              <label for="incident_time">Time of Occurrence:</label>
              <input type="time" id="incident_time" readonly>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="incident_type">Incident Type:</label>
              <input type="text" id="incident_type" readonly>
            </div>
            <div class="form-group">
              <label for="severity">Severity Level:</label>
              <input type="text" id="severity" readonly>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="department">Responsible Dept. :</label>
              <input type="text" id="department" readonly>
            </div>
            <div class="form-group">
              <label for="location">Location:</label>
              <input type="text" id="location" readonly>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="hazard_type">Primary Hazard:</label>
              <input type="text" id="hazard_type" readonly>
            </div>
            <div class="form-group">
              <label for="ppe_used">PPE Being Worn:</label>
              <input type="text" id="ppe_used" readonly>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="injury_type">Injuries Reported:</label>
              <input type="text" id="injury_type" readonly>
            </div>
            <div class="form-group">
              <label for="investigation_level">Investigation Required:</label>
              <input type="text" id="investigation_level" readonly>
            </div>
          </div>

          <div class="form-group">
            <label for="description">Incident Description:</label>
            <textarea id="description" readonly></textarea>
          </div>

          <div class="immediate-action-row-scroll">
            <div class="form-group" style="display: flex; align-items: flex-start; gap: 6px; min-width: 700px;">
              <div class="immediate-action-field" style="flex-basis: 70%; min-width: 0; display: flex; flex-direction: column;">
                <label for="immediate_action">Immediate Action</label>
                <textarea id="immediate_action" rows="5" style="max-width:100%; width: 100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="who_action">Who:</label>
                <textarea id="who_action" rows="5" style="width:100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="when_action_date">When:</label>
                <textarea id="when_action_date" rows="5" style="width:100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="status_action">Status</label>
                <textarea id="status_action" rows="5" style="width:100%;" readonly></textarea>
              </div>
            </div>
          </div>

          <div class="form-group">
            <h3 class="uploaded-images-title">Uploaded Images</h3>
            <div id="imageDisplayContainer" class="image-previews-container"></div>
          </div>

          <div class="form-group">
            <label for="hr_investigation">Investigation</label>
            <textarea id="hr_investigation" placeholder="Investigation notes will be added here..." readonly></textarea>
          </div>

          <div class="immediate-action-row-scroll">
            <div class="form-group" style="display: flex; align-items: flex-start; gap: 6px; min-width: 700px;">
              <div class="immediate-action-field" style="flex-basis: 70%; min-width: 0; display: flex; flex-direction: column;">
                <label for="corrective_actions">Corrective Actions</label>
                <textarea id="corrective_actions" rows="5" style="max-width:100%; width: 100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="corrective_who">Who:</label>
                <textarea id="corrective_who" rows="5" style="width:100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="corrective_when">When:</label>
                <textarea id="corrective_when" rows="5" style="width:100%;" readonly></textarea>
              </div>
              <div class="immediate-action-field" style="display: flex; flex-direction: column; justify-content: flex-start; flex-basis: 22%; min-width: 80px;">
                <label for="corrective_status">Status</label>
                <textarea id="corrective_status" rows="5" style="width:100%;" readonly></textarea>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="follow_up_required">Follow-up Required</label>
            <select id="follow_up_required" disabled>
              <option value="">Select</option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>

          <div class="form-group">
            <label for="status">Status</label>
            <select id="status" disabled>
              <option value="">Select Status</option>
              <option value="Under Investigation">Under Investigation</option>
              <option value="Investigation Complete">Investigation Complete</option>
              <option value="Action Required">Action Required</option>
              <option value="Closed">Closed</option>
            </select>
          </div>

          <div class="form-group">
            <label for="remarks">Remarks</label>
            <textarea id="remarks" placeholder="Additional remarks..." readonly></textarea>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-back" onclick="window.history.back();">Back</button>
            <button type="submit" class="btn-save hidden" id="saveButton">Save Changes</button>
            <button type="button" class="btn-save btn-delete hidden" id="deleteButton" style="background-color: #dc3545; margin-left: 10px;">Delete</button>
          </div>
        </form>
        <div id="loading-message" style="text-align: center; padding: 20px;">Loading incident details...</div>
        <div id="error-message" style="color: red; text-align: center; padding: 20px; display: none;"></div>
      </div>
    </div>
  </main>
  <script type="module" src="../js/safety-incident-actions.js"></script>
</body>
</html> 
