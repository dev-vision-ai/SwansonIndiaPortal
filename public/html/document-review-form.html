<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>DCC Review Form - Document Control Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/employee-dashboard.css">
    <link rel="stylesheet" href="../css/common-header.css">
    <!-- MT-job-requisition-form.css removed: replicated locally below to avoid external dependency -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Inline styles removed. Use Tailwind utilities or external css files (e.g., employee-dashboard.css) for styling. -->
</head>
<body class="bg-gray-100 text-gray-900 font-roboto-medium min-h-screen">
    <div class="header-container">
        <button type="button" class="header-back-button" onclick="(window.history.length > 1 ? window.history.back() : window.location.href='dcn-list.html')">Back</button>
        <div class="header-title">DCC Review Form</div>
        <div class="company-logo">
            <img src="../assets/logo.png" alt="Company Logo">
        </div>
    </div>

    <!-- DCC Review Form styles: MJR-like UI inline (no header) -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        /*
         * Part of MT-job-requisition-form.css copied inline here to avoid external file reference.
         * NOTE: header selectors (.header-container, .header-title) are intentionally excluded
         * so we do not override the global header for the site.
         */
        :root{
            --primary-color: #002E7D;
            --primary-gradient: linear-gradient(45deg, #002E7D, #0046C7);
            --background: #eaf1fa;
            --form-bg: #fff;
            --border-color: #ced4da;
            --shadow: 0 4px 10px rgba(0,0,0,0.12);
        }

body {
    font-family: 'Inter', sans-serif;
    background-color: #eaf1fa;
    background-image: url('data:image/svg+xml;utf8,<svg width="60" height="30" viewBox="0 0 60 30" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="10" stroke="%2399aabb" stroke-width="1" fill="none" opacity="0.10"/><circle cx="45" cy="15" r="10" stroke="%2399aabb" stroke-width="1" fill="none" opacity="0.10"/><line x1="25" y1="15" x2="35" y2="15" stroke="%2399aabb" stroke-width="1" opacity="0.10"/></svg>');
    background-size: 60px 30px;
    background-repeat: repeat;
    background-position: center center;
    background-attachment: fixed;
    color: #333;
    line-height: 1.6;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    padding-top: 2.5rem; /* Adjusted spacing */
}

        /* Container like MJR form */
        .dcc-container { max-width: 1000px; margin: 3rem auto 1rem auto; }
        .dcc-card { background: var(--form-bg); padding: 0.75rem; border-radius: 8px; box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.08); }
        .maintenance-form-section { width: 100%; max-width: 1000px; background: var(--form-bg); border-radius: 0.5rem; padding: 0.75rem; padding-top: 0.75rem; margin: 0 auto; box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.08); position: relative; }

        /* Separate main sections */
        .document-viewer-main { max-width: 1000px; margin: 1rem auto 0.25rem auto; position: relative; z-index: 1; }
        .dcc-review-form-main { max-width: 1000px; margin: 0.25rem auto 1rem auto; position: relative; z-index: 1; }

        /* Document viewer styles */
        .document-viewer-container { position: relative; width: 100%; height: 450px; border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: #f9fafb; transition: height 0.3s ease; z-index: 1; }
        .document-viewer-container.expanded { height: 800px; }

        /* Viewer toggle button */
        .viewer-toggle-btn { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 6px; padding: 0 6px; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: all 0.18s ease; height: 28px; line-height: 1; }
        .viewer-toggle-btn:hover { background: #e5e7eb; border-color: #9ca3af; }
        .viewer-toggle-btn svg { transition: transform 0.25s ease; display: block; width: 18px; height: 18px; }
        .viewer-toggle-btn.expanded svg { transform: rotate(180deg); }
        .viewer-open-btn { background: #fff; border: 1px solid #d1d5db; border-radius: 6px; padding: 0 6px; display: inline-flex; align-items: center; justify-content: center; height: 28px; cursor: pointer; }
        .viewer-open-btn[disabled] { opacity: 0.5; cursor: default; }
        .viewer-open-btn svg { width: 16px; height: 16px; display: block; }
        .document-viewer-placeholder { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; flex-direction: column; background: #f9fafb; }
        .document-placeholder-content { text-align: center; }
        .document-viewer-iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        /* Form section and header style */
        .dcc-section { margin-bottom: 0.5rem; }
        .dcc-title { font-size: 1.2rem; font-weight: 600; color: var(--primary-color); margin-bottom: 0.75rem; display:block; }
        .section-header { font-size: 0.95rem; font-weight: 600; color: var(--primary-color); margin-bottom:0.25rem; padding-bottom: 0.25rem; border-bottom: 1px solid #dee2e6; }
        /* Ensure header contents (title + button) are vertically centered */
        .document-viewer-main .section-header { display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; }

        /* Grid layout */
        .dcc-grid { display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:0.75rem; }
        .span-2 { grid-column: 1 / -1; }
        .dcc-grid-3 { display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:0.75rem; }
        .dcc-details-container { border: 2px solid #ddd; border-radius: 8px; padding: 0.75rem; background: #fafafa; margin-bottom: 0.75rem; }

        /* Inputs & labels like MJR */
        label { display:block; font-weight:500; margin-bottom:0.25rem; color:#222; }
        input[type="text"], input[type="date"], select, textarea, .dcc-input { width:100%; padding:0.56rem; border:1px solid var(--border-color); border-radius:6px; background: white; box-sizing:border-box; }
        input:focus, select:focus { outline:none; border-color: #007bff; box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.12); }
        textarea:focus { outline:none; }
        textarea, .dcc-textarea { min-height: 36px; resize:vertical; box-sizing:border-box; }
        textarea.dcc-large { min-height: 80px; }
        /* Override focus styles for textareas in table cells */
        table .dcc-textarea:focus { border-color: inherit; box-shadow: none; }

        /* Button container (MJR) */
        .button-container { display:flex; gap: var(--form-element-spacing-desktop); justify-content:center; margin-top: 0.75rem; }

        /* Submit button style from MJR */
        .submit-btn { padding:8px 16px; border-radius:0.4rem; background:var(--primary-gradient); color:white; border:none; cursor:pointer; }
        /* MJR-like hover: subtle darken and inner shadow, no lift/pop-up effect */
        .submit-btn:hover {
            background: linear-gradient(45deg, #002e7d, #003ea8); /* slightly darker gradient */
            box-shadow: inset 0 -3px 6px rgba(0,0,0,0.08);
        }
        .submit-btn:active { transform: none; box-shadow: inset 0 -2px 4px rgba(0,0,0,0.06); }

        /* small responsive tweaks used by MJR */
        @media (max-width:768px) {
            .maintenance-form-section { padding: 0.75rem; }
            .document-viewer-main { max-width: 100%; margin: 1rem 1rem 1rem 1rem; position: relative; z-index: 1; }
            .dcc-review-form-main { max-width: 100%; margin: 1rem 1rem 1rem 1rem; position: relative; z-index: 1; }
            .document-viewer-container { height: 400px; }
        }

        /* Laptop/tablet responsive adjustments */
        @media (max-width: 1200px) {
            .document-viewer-main { max-width: 100%; margin: 1rem 1.5rem 0.25rem 1.5rem; position: relative; z-index: 1; }
            .dcc-review-form-main { max-width: 100%; margin: 0.25rem 1.5rem 1rem 1.5rem; position: relative; z-index: 1; }
            .document-viewer-container { height: 450px; }
            .document-viewer-container.expanded { height: 650px; }
            .maintenance-form-section { padding: 0.75rem; }
        }

        /* Desktop responsive adjustments for expanded viewer */
        @media (min-width: 1201px) {
            .document-viewer-container.expanded { height: 900px; }
        }
        /* Table textarea styling */
        table td textarea { resize: none; overflow: hidden; }
        table tbody tr { height: 80px; }
        /* Contenteditable cells */
        .dcc-cell { outline: none; word-wrap: break-word; white-space: pre-wrap; background: #fafafa; cursor: text; }

        /* Reviewer name cell alignment */
        .reviewer-name-cell { text-align: center; vertical-align: middle; }
        .reviewer-name-header { text-align: center; vertical-align: middle; }

        /* Make the sign-off table body background white; keep header color consistent with other tables */
        .dcc-details-container table {
            background: #ffffff;
        }
        .dcc-details-container table thead th {
            background-color: #eef2f6;
            border-bottom: 2px solid #333;
        }
        .dcc-details-container table tbody td {
            background: #ffffff;
        }

        /* DCN List Table Styling */
        .dcc-button {
            background: #2563eb;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .dcc-button:hover {
            background: #1d4ed8;
        }
        .dcc-button-secondary {
            background: #6b7280;
            color: white;
        }
        .dcc-button-secondary:hover {
            background: #4b5563;
        }
        /* Keep checkboxes visually normal when marked readonly via data-readonly attribute */
        input[type="checkbox"][data-readonly="true"] {
            pointer-events: none; /* prevent interaction */
            cursor: default;
            opacity: 1; /* ensure not greyed out */
        }

        /* Base font sizing: keep content consistent; headers are +2px */
        :root {
            --base-font-size: 13px;
            --header-font-size: calc(var(--base-font-size) + 2px);
        }

        .dcc-card,
        .dcc-details-container,
        .dcc-section,
        .document-viewer-container,
        label,
        input,
        select,
        textarea,
        .dcc-input,
        table td,
        table th,
        .button-container button {
            font-size: var(--base-font-size) !important;
            line-height: 1.4 !important;
        }

        /* Headers kept slightly larger (+2px from base) */
        .section-header,
        .dcc-title,
        .dcc-details-container table thead th {
            font-size: var(--header-font-size) !important;
            font-weight: 600 !important;
        }
    </style>

    <!-- DCN table removed: form page is now form-only. Use document-review-form-list.html for table view. -->

    <!-- Document Viewer Main Section -->
    <main class="document-viewer-main">
        <!-- Document Viewer Container -->
        <div class="dcc-document-viewer">
            <div class="dcc-card maintenance-form-section">
                <div class="dcc-section">
                    <div class="section-header">
                        <span>Document Viewer</span>
                        <div class="viewer-controls" style="display:flex; gap:0.5rem; align-items:center;">
                            <button id="openDCNForm" class="viewer-open-btn" title="View DCN Form" aria-label="View DCN Form" style="background: #2563eb; color: white; padding: 4px 6px; font-weight: 500; font-size: 13px; height: auto; line-height: 1.2;" disabled>
                                View DCN Form
                            </button>
                            <button id="openViewerNewWindow" class="viewer-open-btn" title="Open document in new window" aria-label="Open document in new window" disabled>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M14 3h7v7" />
                                    <path d="M10 14L21 3" />
                                    <path d="M21 21H3V3" />
                                </svg>
                            </button>
                            <button id="toggleViewerSize" class="viewer-toggle-btn" title="Expand/Minimize Viewer">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6,9 12,15 18,9"></polyline>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="documentViewerContainer" class="document-viewer-container">
                        <div id="documentViewerPlaceholder" class="document-viewer-placeholder">
                            <div class="document-placeholder-content">
                                <svg style="width:64px; height:64px; margin:0 auto 1rem; color:#9ca3af;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <p style="font-weight:500; margin-bottom:0.5rem; color:#6b7280;">No document available</p>
                                <p style="font-size:0.85rem; color:#9ca3af;">Document will be displayed here when available</p>
                            </div>
                        </div>
                        <iframe id="documentViewer" class="document-viewer-iframe" style="display: none;" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Document Review Form Main Section -->
    <main class="dcc-review-form-main">
        <section class="dcc-card maintenance-form-section">
            <div class="dcc-section">
                <div class="section-header">DCN Review Form - Document Control Center</div>
                <form id="dccReviewForm">
                    <!-- Document Header Info -->
                    <div class="dcc-details-container">
                        <div class="dcc-grid">
                            <div class="form-group">
                                <label for="effective_date">Effective Date:</label>
                                <input class="dcc-input" id="effective_date" type="date" />
                            </div>
                            <div class="form-group" style="text-align: right;">
                                <label for="dcn_no">DCN No:</label>
                                <input class="dcc-input" id="dcn_no" placeholder="Auto-generated" readonly />
                            </div>
                        </div>
                    </div>

                    <!-- Document Details -->
                    <div class="dcc-details-container">
                        <div style="display: flex; gap: 0.75rem; align-items: flex-end;">
                            <div class="form-group" style="flex: 1;">
                                <label for="document_no">Document No</label>
                                <input class="dcc-input" id="document_no" placeholder="Document number" />
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="revision_no">Revision No</label>
                                <input class="dcc-input" id="revision_no" placeholder="Revision number" />
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="review_date">Review Date</label>
                                <input class="dcc-input" id="review_date" type="date" />
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 0.75rem;">
                            <label for="document_title">Document Title</label>
                            <input class="dcc-input" id="document_title" placeholder="Document title" />
                        </div>
                    </div>

                    <!-- Purpose of Review -->
                    <div class="dcc-details-container">
                        <div class="section-header">Purpose of Review (Please âœ“ the required option)</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <div>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 400;">
                                    <input type="checkbox" id="purpose_new_doc" />
                                    New Establishment of a Document
                                </label>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 400;">
                                    <input type="checkbox" id="purpose_amendment_form" />
                                    Amendment on the Form (OPL, PPT)
                                </label>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 400;">
                                    <input type="checkbox" id="purpose_amendment_content" />
                                    Amendment on the Content
                                </label>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 400;">
                                    <input type="checkbox" id="purpose_obsolescence" />
                                    Obsolescence of a Document
                                </label>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 400;">
                                    <input type="checkbox" id="purpose_review_annual" />
                                    Review (Annual/ Validation/ SOP Review)
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Department Sign-off Table -->
                    <div class="dcc-details-container">
                        <div class="section-header">Agreed Upon by HOD's</div>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 0.5rem;">
                            <thead>
                                <tr style="background-color: #eef2f6; border-bottom: 2px solid #333;">
                                    <th style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px;">Department</th>
                                    <th class="reviewer-name-header" style="border: 1px solid #999; padding: 0.5rem; width: 120px;">Name</th>
                                    <th style="border: 1px solid #999; padding: 0.5rem; text-align: left;">Comments/Recommendations</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">QMR</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="QMR"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">PU</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="PU"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">AD/GA</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="AD/GA"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">HR</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="HR"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">PD/PC</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="PD/PC"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">WH</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="WH"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">SA</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="SA"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">MT/IT</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="MT/IT"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">QC</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="QC"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">FN</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="FN"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">QA</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="QA"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #999; padding: 0.5rem; text-align: center; width: 80px; vertical-align: middle;">DCC</td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; width: 120px; vertical-align: middle;" class="reviewer-name-cell" data-dept="DCC"></td>
                                    <td style="border: 1px solid #999; padding: 0.5rem; height: 80px; vertical-align: top; overflow: hidden;" contenteditable="true" class="dcc-cell"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="button-container">
                        <button class="submit-btn" id="submit-dcc-review">Submit Review</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <!-- inline script moved to ../js/document-review-form.js to keep HTML clean -->
    <script type="module" src="../js/document-review-form.js"></script>
</body>
</html>
